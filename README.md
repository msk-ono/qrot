# Approximating Qubit Z-Rotation with H, S, T

This C++ implementation is based on the algorithm presented in the paper [Optimal ancilla-free Clifford+T approximation of z-rotations](https://arxiv.org/abs/1403.2975).
This program is developed as part of my study.
Currenthly this program demonstrates notably poorer performance in comparison to the Haskell program [GridSynth](https://www.mathstat.dal.ca/~selinger/newsynth/) developed by the authors of the paper.

While GridSynth is distributed under the GPL license, my implementation has been developed independently without referencing the original code. Therefore, I am releasing this implementation under the MIT license.

## Building and Testing

To build this library, use Boost.Multiprecision, Boost.Program_options, and GoogleTest. Follow these commands:

```sh
$ cmake -S . -B build
$ cmake --build build
$ ctest --test-dir build
```

## Implemented Algorithms

* [Optimal ancilla-free Clifford+T approximation of z-rotations](https://arxiv.org/abs/1403.2975)
* [Fast and efficient exact synthesis of single qubit unitaries generated by Clifford and T gates](https://arxiv.org/abs/1206.5236v4)

## TODO

* Implement [Representation of Quantum Circuits with Clifford and Ï€/8 Gates](https://arxiv.org/abs/0806.3834)
  * Output the approximated gates in a normal form
* Enhance Speed
  * The prime factorization process currently consumes a significant amount of time
  * Implement the Quadratic Sieve algorithm
  * Use OpenMP
* Address numerical errors arising from floating-point calculations

## Run Results

The execution time of gridsynth_cpp is notably influenced by the success or failure of prime factorization.

* CPU: AMD Ryzen 7 3700X 8-Core Processor

```sh
$ time ./gridsynth_cpp pi/128 -d 10
TCount = 104
STHSTHTHTHTHSTHSTHSTHTHTHTHTHSTHTHSTHTHSTHSTHSTHTHTHSTHTHTHTHTHTHSTHSTHTHTHTHSTHSTHSTHTHTHSTHTHTHTHSTHSTHSTHTHTHTHSTHTHTHSTHSTHTHTHSTHSTHTHTHSTHSTHSTHSTHSTHSTHTHTHTHSTHSTHTHTHSTHSTHSTHSTHSTHSTHSTHTHSTHTHSTHTHTHSTHSTHSTHSTHSTHTHSTHSTHSTHTHSTHSTHSTHTHTHSTHSTHTHSSTHSSSHT

real    0m0.285s
user    0m0.275s
sys     0m0.010s
```

```sh
$ time ./gridsynth_cpp pi/128 -d 20
TCount = 202
THSTHTHSTHTHSTHSTHSTHTHTHSTHTHSTHTHTHSTHSTHSTHTHTHTHSTHSTHTHTHSTHSTHTHSTHTHTHSTHTHTHTHSTHSTHSTHSTHSTHSTHSTHTHSTHSTHSTHTHSTHSTHTHSTHTHSTHTHTHSTHSTHTHTHTHSTHSTHTHTHSTHTHTHTHTHTHSTHTHTHTHSTHTHSTHTHSTHSTHTHTHSTHSTHTHSTHTHTHSTHTHSTHTHTHSTHTHTHTHSTHTHTHSTHSTHTHSTHTHSTHTHSTHTHSTHTHSTHSTHTHTHSTHTHSTHSTHTHSTHTHTHTHSTHTHSTHSTHSTHSTHSTHTHSTHSTHSTHTHSTHTHSTHTHSTHSTHSTHSTHSTHSTHTHTHTHSTHTHTHTHTHTHTHSTHTHSTHSTHTHSTHTHTHTHSTHTHTHSTHTHSTHSTHTHSTHTHTHTHSTHTHSTHTHTHSTHTHSTHSTHTHSTHTHTHSTHTHTHTHSTHSTHSTHTHSTHTHSSTHSSTHSS

real    0m9.526s
user    0m9.505s
sys     0m0.020s
```

```sh
$ time ./gridsynth_cpp pi/128 -d 30
TCount = 298
SHSTHSTHSTHSTHTHTHTHTHTHSTHSTHSTHTHTHTHSTHSTHTHTHSTHSTHTHSTHSTHSTHSTHTHSTHSTHSTHTHSTHSTHTHSTHSTHTHTHSTHSTHTHSTHTHSTHTHTHTHTHSTHTHTHSTHTHSTHSTHSTHSTHTHSTHSTHSTHTHSTHTHSTHTHSTHTHTHTHTHSTHSTHSTHTHTHTHSTHSTHTHTHSTHSTHTHTHSTHSTHTHSTHTHSTHSTHSTHTHTHSTHSTHTHSTHTHTHTHTHTHSTHTHTHSTHSTHSTHSTHSTHSTHTHTHTHTHTHSTHSTHTHTHSTHTHTHSTHTHTHTHTHTHTHSTHSTHSTHTHSTHSTHSTHTHSTHSTHSTHTHSTHSTHSTHTHTHTHSTHSTHSTHTHSTHSTHSTHTHSTHSTHSTHSTHTHSTHSTHTHTHTHSTHTHSTHSTHSTHSTHSTHSTHSTHTHSTHTHSTHSTHTHTHSTHTHSTHTHSTHSTHSTHSTHTHSTHTHSTHTHTHTHTHSTHSTHSTHTHTHSTHSTHTHSTHSTHSTHSTHTHSTHTHTHSTHTHSTHTHSTHTHSTHTHTHTHTHSTHSTHTHSTHTHSTHTHSTHTHSTHSTHTHSTHSTHSTHTHTHTHTHSTHTHTHSTHTHSTHSTHTHSTHSTHTHSTHTHTHTHSTHTHSTHTHTHSTHSTHSTHTHSTHSTHTHSTHSTHSTHSTHTHSTHTHTHTHSTHTHTHTHTHSTHTHSTHTHTHTHSTHSTHSTHSHSSTHT

real    0m3.680s
user    0m3.650s
sys     0m0.030s
```

```sh
$ time ./gridsynth_cpp pi/128 -d 40
TCount = 400
STHTHSTHSTHTHTHSTHSTHSTHSTHSTHSTHTHTHSTHTHTHTHTHTHTHTHSTHTHSTHSTHSTHTHSTHTHTHSTHSTHSTHTHTHSTHSTHSTHSTHSTHTHSTHTHSTHSTHTHSTHTHSTHSTHTHTHSTHTHTHSTHTHTHTHTHSTHSTHTHSTHSTHSTHSTHSTHSTHSTHTHTHSTHTHTHTHSTHSTHTHSTHTHSTHSTHSTHTHSTHTHTHTHTHSTHSTHTHSTHTHSTHSTHSTHSTHSTHSTHSTHTHTHTHSTHSTHSTHTHTHSTHSTHTHTHSTHTHTHTHSTHTHTHTHTHSTHSTHSTHSTHSTHSTHTHSTHSTHTHTHSTHTHTHTHTHTHTHSTHTHSTHTHSTHSTHSTHSTHTHSTHSTHSTHSTHTHSTHTHTHTHTHTHTHTHSTHTHTHTHSTHTHTHSTHSTHTHSTHSTHTHTHTHSTHTHTHTHSTHTHTHSTHTHSTHTHSTHSTHTHSTHSTHSTHTHSTHSTHTHTHTHSTHSTHSTHTHTHTHSTHSTHTHTHTHTHTHSTHSTHTHTHSTHSTHSTHSTHTHTHSTHSTHSTHTHSTHTHTHTHTHSTHTHSTHSTHSTHTHTHTHSTHSTHTHSTHTHTHTHSTHSTHTHSTHTHSTHSTHTHSTHSTHSTHTHTHTHSTHTHSTHTHSTHSTHSTHSTHSTHTHSTHSTHTHTHTHSTHTHTHSTHTHTHSTHTHSTHSTHSTHTHTHSTHSTHSTHSTHSTHTHSTHSTHTHTHTHSTHSTHTHSTHTHTHSTHTHSTHTHSTHSTHSTHTHSTHSTHTHTHSTHTHTHTHSTHSTHTHTHTHTHSTHTHTHTHSTHSTHSTHTHTHTHSTHTHSTHTHTHSTHTHTHTHSTHSTHSTHSTHTHSTHTHSTHTHSTHTHTHSTHTHSTHTHTHTHTHSTHTHTHTHTHTHTHSTHTHSTHTHSTHSTHTHTHSTHTHSTHTHSTHTHSTHSTHSTHSTHTHSTHTHTHSSSTHSSSTHT

real    0m4.333s
user    0m4.323s
sys     0m0.010s
```

```sh
$ time ./gridsynth_cpp pi/128 -d 50
TCount = 500
SHTHTHTHSTHSTHSTHSTHSTHSTHSTHTHTHSTHSTHSTHTHTHTHTHSTHSTHTHSTHSTHSTHSTHSTHSTHSTHTHTHTHTHTHSTHSTHSTHSTHSTHTHSTHSTHSTHTHTHSTHSTHSTHTHTHSTHTHTHTHTHSTHSTHSTHTHSTHSTHSTHSTHSTHSTHTHTHTHSTHTHTHSTHSTHSTHSTHSTHTHSTHTHSTHTHSTHTHTHSTHSTHTHSTHSTHTHSTHTHSTHTHSTHSTHSTHSTHTHSTHSTHTHTHTHSTHTHSTHTHSTHSTHTHTHTHSTHTHSTHSTHTHTHSTHSTHTHSTHTHTHSTHSTHSTHTHSTHSTHSTHTHTHTHSTHSTHSTHSTHSTHSTHSTHTHSTHSTHSTHSTHSTHSTHTHTHTHTHTHTHSTHTHTHSTHTHTHSTHTHTHSTHTHTHSTHSTHSTHTHSTHTHSTHSTHSTHTHTHTHSTHTHSTHSTHTHTHTHTHSTHSTHSTHSTHSTHSTHTHSTHSTHTHTHTHSTHSTHSTHSTHTHTHTHSTHTHTHSTHTHSTHSTHSTHTHSTHTHTHTHTHTHSTHTHTHSTHSTHSTHTHSTHSTHTHTHTHTHTHTHTHSTHSTHTHTHSTHSTHSTHSTHSTHTHSTHTHTHTHTHSTHTHTHTHTHSTHTHSTHTHTHTHSTHTHTHTHTHSTHTHTHSTHSTHSTHSTHTHSTHTHTHSTHTHSTHSTHSTHTHTHSTHTHSTHTHSTHTHSTHSTHTHSTHTHSTHTHTHSTHSTHTHSTHTHTHSTHTHTHSTHSTHTHSTHTHSTHTHTHTHSTHSTHTHTHSTHSTHTHTHSTHSTHSTHSTHTHTHSTHSTHTHTHTHTHSTHTHTHSTHTHSTHSTHTHTHTHTHTHTHTHSTHTHTHTHSTHSTHTHTHTHTHSTHSTHTHSTHTHTHTHSTHSTHSTHTHTHTHSTHSTHTHTHSTHSTHSTHTHTHTHTHSTHTHSTHSTHSTHTHSTHSTHSTHTHTHSTHTHTHSTHTHSTHTHTHSTHSTHTHTHSTHTHSTHTHSTHTHSTHSTHSTHSTHSTHTHTHSTHTHSTHTHSTHTHSTHSTHTHTHTHSTHTHTHTHSTHTHSTHTHTHSTHSTHTHTHSTHSTHSTHSTHSTHSTHSTHTHSTHSTHTHTHTHTHSTHTHTHTHTHSTHSTHSTHTHTHSTHTHSTHTHTHSTHTHTHSTHTHTHSTHTHTHTHSTHTHSTHSTHTHTHSTHSTHTHTHSTHTHTHSHSTHSST

real    0m27.500s
user    0m27.480s
sys     0m0.020s
```

```sh
$ time ./gridsynth_cpp pi/128 -d 60
TCount = 598
HSTHTHSTHTHTHTHSTHSTHTHSTHTHTHSTHTHSTHSTHTHSTHSTHTHTHSTHSTHTHSTHTHSTHSTHSTHSTHSTHTHTHTHTHSTHTHTHTHTHTHSTHTHSTHTHSTHSTHTHSTHSTHSTHSTHSTHTHSTHTHSTHSTHSTHTHTHTHTHTHSTHTHTHSTHTHTHSTHSTHSTHTHTHTHSTHTHSTHSTHTHTHTHSTHSTHSTHTHSTHTHSTHTHTHTHSTHTHSTHTHTHSTHTHTHTHTHSTHSTHSTHSTHSTHTHTHTHTHSTHTHTHTHTHSTHTHTHTHSTHSTHTHSTHSTHTHSTHSTHTHTHSTHSTHTHTHTHSTHSTHTHSTHTHTHSTHTHSTHTHTHTHTHTHTHTHTHSTHTHTHSTHSTHSTHSTHTHTHTHTHTHSTHSTHSTHSTHTHSTHSTHSTHSTHTHSTHTHSTHSTHTHSTHTHTHSTHTHSTHSTHTHTHSTHSTHSTHSTHTHSTHSTHSTHTHTHTHTHSTHTHSTHSTHSTHTHSTHSTHSTHSTHSTHTHSTHSTHSTHTHSTHTHSTHTHSTHTHSTHSTHSTHTHTHTHSTHSTHSTHSTHTHSTHSTHTHTHSTHSTHTHSTHSTHTHSTHSTHTHSTHSTHSTHTHSTHSTHTHSTHSTHTHTHTHSTHSTHTHTHTHSTHSTHSTHTHSTHSTHSTHTHTHTHSTHTHTHSTHTHSTHTHSTHTHSTHSTHSTHSTHSTHTHSTHTHSTHTHSTHTHSTHTHTHSTHTHSTHTHSTHTHTHTHSTHTHSTHSTHSTHTHSTHTHTHTHSTHSTHSTHTHSTHSTHTHTHSTHTHTHTHSTHTHSTHSTHTHTHTHSTHTHTHSTHSTHSTHSTHTHSTHTHSTHTHSTHTHTHTHSTHSTHSTHSTHSTHSTHSTHSTHTHTHTHSTHTHSTHSTHSTHTHSTHTHSTHSTHTHSTHSTHTHTHTHTHSTHTHTHSTHTHTHTHTHTHSTHSTHTHTHSTHTHTHSTHSTHSTHTHSTHTHSTHTHSTHTHSTHTHSTHSTHSTHTHSTHSTHTHTHTHSTHSTHTHTHSTHTHTHTHSTHTHSTHTHTHTHTHTHTHTHSTHSTHSTHTHTHSTHTHTHSTHTHSTHTHTHTHSTHSTHSTHSTHTHTHTHTHTHSTHTHSTHTHSTHTHSTHTHSTHSTHSTHTHSTHTHSTHTHTHTHTHSTHTHSTHSTHSTHTHTHTHSTHSTHTHTHSTHSTHTHTHTHSTHSTHSTHTHTHTHTHSTHTHTHSTHSTHTHSTHTHTHSTHTHSTHSTHTHSTHTHTHSTHSTHSTHTHTHTHSTHTHTHTHSTHSTHSTHTHSTHTHTHSTHSTHSTHSTHTHTHTHSTHTHSTHTHSTHTHSTHSTHSTHTHSTHSTHSTHTHTHTHSTHSTHTHSTHSTHSTHSTHTHTHTHTHTHTHSTHSTHTHSTHTHSTHSTHSTHTHSTHSTHTHSTHTHSTHSTHTHTHTHSTHSTHTHTHSTHTHTHSTHSSHSHTHSH

real    0m10.962s
user    0m10.951s
sys     0m0.010s
```

```sh
$ time ./gridsynth_cpp pi/128 -d 70
TCount = 700
HTHTHTHTHTHSTHSTHTHSTHSTHTHSTHTHSTHSTHSTHSTHSTHTHTHSTHTHSTHSTHTHSTHTHTHTHTHTHTHSTHSTHSTHSTHTHTHSTHSTHTHTHTHSTHSTHTHSTHSTHTHSTHTHSTHTHTHTHTHTHSTHSTHTHTHTHTHSTHSTHSTHTHSTHSTHSTHTHTHSTHTHSTHSTHTHSTHSTHTHTHTHSTHSTHTHSTHTHSTHSTHSTHTHTHSTHTHSTHTHTHSTHSTHSTHSTHSTHTHSTHTHTHSTHTHSTHSTHSTHTHTHTHSTHTHSTHSTHTHTHTHTHSTHTHTHTHSTHTHTHTHSTHTHSTHSTHSTHSTHSTHTHTHSTHSTHTHTHSTHTHTHSTHSTHSTHTHSTHTHTHTHSTHSTHTHSTHTHSTHTHSTHSTHTHSTHTHSTHSTHSTHSTHTHSTHTHSTHTHTHTHSTHTHTHTHTHTHSTHTHTHTHSTHSTHSTHSTHSTHTHSTHSTHSTHSTHTHSTHTHSTHTHSTHSTHTHTHSTHSTHSTHTHTHTHSTHSTHTHTHTHTHTHSTHTHSTHTHSTHSTHTHSTHSTHTHSTHSTHTHSTHTHTHSTHSTHSTHSTHSTHTHTHTHSTHSTHTHSTHSTHSTHTHTHTHSTHTHSTHSTHTHTHSTHSTHTHSTHSTHSTHTHSTHSTHSTHSTHTHSTHSTHSTHSTHSTHTHTHTHSTHSTHSTHTHTHSTHSTHSTHTHSTHSTHTHTHSTHTHSTHSTHSTHSTHSTHSTHTHTHSTHSTHTHSTHSTHTHSTHTHSTHTHSTHSTHSTHTHTHSTHTHTHTHTHTHSTHTHSTHSTHSTHSTHTHTHTHSTHSTHSTHTHSTHTHTHTHSTHTHTHSTHTHSTHTHTHSTHTHSTHTHTHSTHSTHSTHSTHSTHTHTHSTHTHSTHSTHSTHTHTHSTHSTHTHTHTHTHTHSTHSTHTHTHSTHTHTHSTHSTHSTHTHTHTHSTHTHTHSTHSTHSTHSTHSTHTHSTHSTHSTHTHTHTHTHTHSTHSTHTHSTHTHSTHTHTHSTHTHSTHSTHTHTHSTHSTHTHSTHSTHSTHTHSTHTHTHSTHTHSTHSTHTHSTHSTHTHTHSTHSTHTHSTHTHSTHSTHTHTHSTHSTHSTHSTHTHTHSTHTHSTHSTHSTHTHTHTHSTHTHTHTHSTHTHTHSTHTHSTHTHSTHSTHSTHTHSTHSTHSTHTHSTHSTHTHSTHTHTHSTHSTHSTHSTHTHTHTHTHTHTHTHSTHSTHSTHTHSTHSTHTHSTHSTHTHTHSTHSTHTHTHSTHSTHTHTHSTHSTHTHTHSTHSTHSTHSTHSTHTHTHTHTHTHSTHTHSTHTHTHSTHTHSTHTHTHTHSTHTHTHTHSTHSTHSTHSTHSTHSTHSTHTHSTHTHTHSTHSTHTHSTHTHSTHSTHSTHTHTHSTHTHTHSTHTHSTHTHSTHSTHSTHTHSTHSTHTHSTHSTHTHSTHTHTHTHSTHTHTHSTHSTHTHSTHTHTHTHTHSTHSTHTHTHSTHSTHSTHSTHSTHSTHTHTHTHSTHTHSTHTHTHTHTHSTHTHSTHTHTHSTHSTHSTHSTHTHSTHSTHSTHTHSTHTHTHSTHTHSTHSTHSTHTHTHSTHSTHSTHTHSTHTHSTHSTHSTHTHSTHSTHTHTHTHSTHTHTHTHSTHSTHTHSTHTHSTHSTHTHSTHSTHTHSTHSTHTHTHTHSTHSTHTHTHTHTHTHTHTHSTHTHSTHTHSTHTHSTHTHSTHSTHTHSTHSTHTHTHSTHS

real    1m12.781s
user    1m12.759s
sys     0m0.020s
```
